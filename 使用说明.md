# 网页内容管理使用说明

## 目录结构

```
pages/
├── _posts/          # 博客文章目录
├── _data/           # 数据文件（置顶文章、链接等）
├── _config.yml      # Jekyll 配置文件
├── manage_content.py # 内容管理脚本
├── 分支分析文档.md   # 分支说明文档
└── 使用说明.md      # 本文件
```

## 环境要求

- Python 3.6+
- PyYAML 库（用于处理 YAML 文件）

安装依赖：
```bash
pip install pyyaml
```

## 内容管理脚本使用

### 1. 列出所有文章

```bash
cd /home/10355407/pages
python3 manage_content.py list
```

输出示例：
```
共 40 篇文章：

  2022-02-17-修复Redisson SortedSet不支持Lambda表达式的构造的Comparator的问题.md
    标题: 修复Redisson SortedSet不支持Lambda表达式的构造的Comparator的问题
    日期: 
    分类: ['Java']
    标签: ['Java','Redis','Redisson']
  ...
```

### 2. 创建新文章

```bash
python3 manage_content.py create \
  --title "文章标题" \
  --categories "分类1" "分类2" \
  --tags "标签1" "标签2" \
  --content "文章内容..."
```

示例：
```bash
python3 manage_content.py create \
  --title "Spring Boot 最佳实践" \
  --categories "Java" "Spring" \
  --tags "Spring Boot" "最佳实践" \
  --content "# Spring Boot 最佳实践\n\n这是文章内容..."
```

### 3. 编辑文章

```bash
python3 manage_content.py edit <文件名> \
  [--title "新标题"] \
  [--content "新内容"] \
  [--categories "分类1" "分类2"] \
  [--tags "标签1" "标签2"]
```

示例：
```bash
# 只修改标题
python3 manage_content.py edit 2022-02-17-xxx.md --title "新标题"

# 修改多个字段
python3 manage_content.py edit 2022-02-17-xxx.md \
  --title "新标题" \
  --tags "新标签1" "新标签2"
```

### 4. 删除文章

```bash
python3 manage_content.py delete <文件名>
```

示例：
```bash
python3 manage_content.py delete 2022-02-17-xxx.md
```

### 5. 管理置顶文章

#### 列出置顶文章
```bash
python3 manage_content.py tops list
```

#### 添加置顶文章
```bash
python3 manage_content.py tops add --url "文章URL"
```

文章 URL 是文章文件名去掉 `.md` 扩展名后的部分，例如：
- 文件名：`2022-02-17-修复Redisson问题.md`
- URL：`2022-02-17-修复Redisson问题`

示例：
```bash
python3 manage_content.py tops add --url "Github-Pages-和-Jekyll的使用"
```

#### 移除置顶文章
```bash
python3 manage_content.py tops remove --url "文章URL"
```

### 6. 更新网站配置

```bash
python3 manage_content.py config <配置键> <配置值>
```

支持嵌套配置，使用点号分隔：
```bash
# 修改网站名称
python3 manage_content.py config name "新网站名称"

# 修改作者名称
python3 manage_content.py config defaults.0.values.author "新作者名"

# 修改分页数量
python3 manage_content.py config paginate 10
```

## 本地开发

### 1. 安装 Jekyll

```bash
# 安装 Ruby 和 Bundler
gem install bundler

# 安装项目依赖（如果有 Gemfile）
cd /home/10355407/pages
bundle install
```

### 2. 启动本地服务器

```bash
bundle exec jekyll serve
# 或
jekyll serve
```

访问：`http://localhost:4000`

### 3. 构建静态网站

```bash
bundle exec jekyll build
```

生成的静态文件在 `_site/` 目录中。

## 文章格式说明

### Front Matter 格式

每篇文章开头需要包含 YAML Front Matter：

```yaml
---
layout: post
title: "文章标题"
categories: ['分类1', '分类2']
tags: ['标签1', '标签2']
author: Feiyizhan
description: "文章描述"
issueId: "文章ID（用于评论系统）"
---
```

### 文件命名规范

- 格式：`YYYY-MM-DD-标题.md`
- 使用连字符分隔
- 避免特殊字符
- 示例：`2024-01-15-Spring-Boot教程.md`

## 常见操作示例

### 完整工作流程

1. **创建新文章**
```bash
python3 manage_content.py create \
  --title "我的新文章" \
  --categories "技术" \
  --tags "教程" "Jekyll" \
  --content "# 我的新文章\n\n这是内容..."
```

2. **设置为置顶**
```bash
python3 manage_content.py tops add --url "我的新文章"
```

3. **本地预览**
```bash
bundle exec jekyll serve
```

4. **编辑文章**
```bash
python3 manage_content.py edit 2024-01-15-我的新文章.md \
  --title "更新后的标题"
```

## 注意事项

1. **文件编码：** 所有文件使用 UTF-8 编码
2. **YAML 格式：** Front Matter 必须使用正确的 YAML 格式
3. **URL 编码：** 置顶文章的 URL 需要 URL 编码（脚本会自动处理）
4. **备份：** 修改前建议先备份重要文件
5. **Git 提交：** 修改后记得提交到 Git 仓库

## 故障排除

### 问题：Python 脚本报错 "No module named 'yaml'"

**解决：**
```bash
pip install pyyaml
```

### 问题：Jekyll 启动失败

**解决：**
1. 检查 Ruby 版本：`ruby --version`
2. 安装依赖：`bundle install`
3. 检查 `_config.yml` 配置是否正确

### 问题：文章不显示

**检查：**
1. 文件是否在 `_posts/` 目录
2. 文件名格式是否正确（YYYY-MM-DD-title.md）
3. Front Matter 格式是否正确
4. 文件编码是否为 UTF-8

## 更多帮助

- Jekyll 官方文档：https://jekyllrb.com/
- GitHub Pages 文档：https://pages.github.com/
- 项目 README：查看 `README.md` 文件

